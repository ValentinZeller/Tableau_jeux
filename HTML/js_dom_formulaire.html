<!DOCTYPE html>
<html>
  <!-- En-tête spécification -->
  <html>
    <!-- En-tête spécification -->
    <head>
      <!-- Gestion des caractères -->
      <meta charset="utf-8">
      <!-- Titre de la page -->
      <title>Formulaire</title>
      <!-- Icone onglet  -->
      <link rel="shortcut icon" type="image/x-icon" href="../contenu/images/zenyatta.png"/>
      <!-- Appel du css depuis un fichier externe-->
      <link rel="stylesheet" href="../CSS/formulaire_style.css" type="text/css" />
      <script type="text/javascript" src="../JS/formulaire_script.js"></script>
    </head>
  <body onload="generateForm()">
    <!-- En-tête identification -->
    <header></header>
    <h1>Formulaire</h1>
      <script>
          function createLabel(name,parent) {
            label = document.createElement('label');
            label.setAttribute('for',name);
            node = document.createTextNode(name + " : ");
            label.appendChild(node);

            parent.appendChild(label);
          }

          function createInput(element) {
            input = document.createElement('input');
            input.setAttribute('id',element.name);
            input.setAttribute('name',element.name);
            input.setAttribute('type',element.type);
            if (element.type == 'tel') {
              input.setAttribute('pattern','[0-9]{2}-[0-9]{2}-[0-9]{2}-[0-9]{2}-[0-9]{2}');
            } else if (element.type == 'text' || element.type == 'email') {
              input.setAttribute('placeholder',element.name);
            } else if (element.type == 'range') {
              input.setAttribute('min',element.min);
              input.setAttribute('max',element.max);
            } 
            return input;
          }

          function createList(element,parent) {
            Object.values(element.value).forEach(value => {
              createLabel(value,parent);
              input = createInput(element);
              input.setAttribute('value',value);
              parent.appendChild(input);
            })
          }


          formData = [{name:"nom",type:"text",civilite:true},
                      {name:"prenom",type:"text",civilite:true},
                      {name:"ddn",type:"date",civilite:true},
                      {name:"email",type:"email"},
                      {name:"email2",type:"email"},
                      {name:"copier_email",type:"radio",value:["oui","non"]},
                      {name:"telephone",type:'tel'},
                      {name:'niveau en anglais',type:"range",min:0,max:100},
                      {name:"genre",type:"radio",civilite:true,value:["homme","femme","autre"]},
                      {name:"programmation",type:"checkbox",value:["js","php","c++","java","pascal"]},
                      {name:"diplome",type:"select",value:["brevet","bac","bts","dut"]},
                      {name:"hobbies",type:"select",value:[{prix:15,image:"automne.jpg"},{prix:19.75,image:"bioshock.jpg"},{prix:20,image:"ete.jpg"},{prix:5.5,image:"hiver.jpg"},{prix:10,image:"printemps.jpg"}]},
                      {name:"reset",type:"reset"},
                      {name:"valider",type:"button"}
                      ];
          
          function generateForm(array) {
            //form
            form = document.createElement('form');
            form.setAttribute('action','js_traitement_formulaire.html');
            form.setAttribute('method','get');
            form.setAttribute('id','form');

            //Div form group pour CSS
            formGroup = document.createElement('div');
            formGroup.setAttribute('class','form-group');

            form.appendChild(formGroup);

            //Fieldset
            civilite = document.createElement('fieldset');
            civilite.setAttribute('id','civilite');
            civilite.setAttribute('name','civilite');

            //Legend du fieldset
            legend = document.createElement('legend');
            legend.innerHTML = 'Civilité :';
            civilite.appendChild(legend);
            formGroup.appendChild(civilite);

            Object.values(formData).forEach( element => {
              div  = document.createElement('div');
              div.setAttribute('class','form-element');

              switch (element.type) {
                case 'range' :
                case 'tel' :
                case 'date' :
                case 'email' :
                case 'text' :
                  createLabel(element.name,div);
                  input = createInput(element);
                  div.appendChild(input);
                  break;
                  
                case 'checkbox' :
                case 'radio' :
                  createLabel(element.name,div);
                  createList(element,div);
                  break;

                case 'select' :
                  createLabel(element.name,div);
                  select = document.createElement('select');
                  select.setAttribute('id',element.name);
                  select.setAttribute('name',element.name);
                  select.setAttribute('multiple',true);
                  Object.values(element.value).forEach(value => {
                    option = document.createElement('option');
                    if (element.name == "hobbies") {
                      option.setAttribute('id',value.image);
                      option.setAttribute('value',value.image+":"+value.prix);
                      option.innerHTML = value.image+" : "+value.prix;
                    } else {
                      option.setAttribute('value',value);
                      option.innerHTML = value;
                    }
                    select.appendChild(option);
                  });
                  div.appendChild(select);
                  break;

                case 'reset' :
                case 'button' :
                  input = createInput(element);
                  input.setAttribute('value',element.name);
                  input.setAttribute('id',element.name);
                  input.setAttribute('class','form-button');
                  if(element.type == "button") {
                    input.addEventListener('click',verifSaisie,2);
                  }
                  div.appendChild(input);
                  break;
              }

              if (element.civilite) {
                civilite.appendChild(div);
              } else {
                formGroup.appendChild(div);
              }

              document.body.appendChild(form);
            });
          }

                    /*
          Afficher la date
          checkbox généré par un tableau
          option généré par un tableau

          curseur niveau en langue
          email1 et email2 : email de secours
          bouton radio pour : email2 = email1
          champs telephone

          bouton submit,reset

          tous les champs ont un label et un placeholder (si possible)

          ajouter le fieldset civilité : genre,nom,prenom,ddn sera entouré d'un fieldset

          partie vos hobbies : liste de jeux : afficher image/prix

          submit : appel la fonction de validation => aller sur la page traitement formulaire (résumé) (js_traitement_formulaire)
          Créer le formulaire avec tableau et type
          */
      </script>
    </form>
    <!-- Pied de page 
    <footer>
      <h3>Contact :</h3>
      <ul>
        <li><a href="mailto:v.zeller@ludus-academie.com" title="Mail">Me contacter par mail</a></li>
        <li>06.18.93.91.06</li>
      </ul>
    </footer>-->
  </body>
</html>
